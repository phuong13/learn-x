import{r as i,ag as $,ah as D,U as I,am as W,j as e,S as P,ap as B,g as te,aI as se,aj as F,an as K,ao as oe,P as le,H as Y,a4 as ie,a5 as ce,aJ as de,aE as pe,x as L,y as Q,Y as E,a7 as y,$ as ue,a0 as he,a1 as me,n as xe,T as k,a6 as ve,a2 as J,d as be,C as fe,a as ge,h as Se,a8 as Ce,aK as je,aL as ye,J as U,w as Le,D as Ie}from"./index-D0u0md9i.js";import{M as V}from"./MenuItem-B0AEuM3_.js";import{C as we}from"./CreateCurriculumForm-y758p6G7.js";import{R as Me}from"./ripple-button-DHKjidbA.js";import"./Close-CXlCFnTY.js";import"./Quiz-BjpjLXgL.js";import"./Cancel-gApFoI2l.js";import"./index-py0PdNds.js";const A=i.createContext({}),X=i.createContext({});function Ne(t){return $("MuiStep",t)}D("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Re=t=>{const{classes:o,orientation:n,alternativeLabel:r,completed:c}=t;return B({root:["root",n,r&&"alternativeLabel",c&&"completed"]},Ne,o)},Te=I("div",{name:"MuiStep",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:n}=t;return[o.root,o[n.orientation],n.alternativeLabel&&o.alternativeLabel,n.completed&&o.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),ze=i.forwardRef(function(o,n){const r=W({props:o,name:"MuiStep"}),{active:c,children:d,className:m,component:u="div",completed:l,disabled:v,expanded:x=!1,index:s,last:b,...S}=r,{activeStep:w,connector:C,alternativeLabel:M,orientation:R,nonLinear:N}=i.useContext(A);let[a=!1,p=!1,h=!1]=[c,l,v];w===s?a=c!==void 0?c:!0:!N&&w>s?p=l!==void 0?l:!0:!N&&w<s&&(h=v!==void 0?v:!0);const g=i.useMemo(()=>({index:s,last:b,expanded:x,icon:s+1,active:a,completed:p,disabled:h}),[s,b,x,a,p,h]),j={...r,active:a,orientation:R,alternativeLabel:M,completed:p,disabled:h,expanded:x,component:u},f=Re(j),z=e.jsxs(Te,{as:u,className:P(f.root,m),ref:n,ownerState:j,...S,children:[C&&M&&s!==0?C:null,d]});return e.jsx(X.Provider,{value:g,children:C&&!M&&s!==0?e.jsxs(i.Fragment,{children:[C,z]}):z})}),ke=te(e.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),Pe=te(e.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function $e(t){return $("MuiStepIcon",t)}const _=D("MuiStepIcon",["root","active","completed","error","text"]);var Z;const De=t=>{const{classes:o,active:n,completed:r,error:c}=t;return B({root:["root",n&&"active",r&&"completed",c&&"error"],text:["text"]},$e,o)},q=I(se,{name:"MuiStepIcon",slot:"Root",overridesResolver:(t,o)=>o.root})(F(({theme:t})=>({display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${_.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${_.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${_.error}`]:{color:(t.vars||t).palette.error.main}}))),We=I("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(t,o)=>o.text})(F(({theme:t})=>({fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}))),Be=i.forwardRef(function(o,n){const r=W({props:o,name:"MuiStepIcon"}),{active:c=!1,className:d,completed:m=!1,error:u=!1,icon:l,...v}=r,x={...r,active:c,completed:m,error:u},s=De(x);if(typeof l=="number"||typeof l=="string"){const b=P(d,s.root);return u?e.jsx(q,{as:Pe,className:b,ref:n,ownerState:x,...v}):m?e.jsx(q,{as:ke,className:b,ref:n,ownerState:x,...v}):e.jsxs(q,{className:b,ref:n,ownerState:x,...v,children:[Z||(Z=e.jsx("circle",{cx:"12",cy:"12",r:"12"})),e.jsx(We,{className:s.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:x,children:l})]})}return l});function Fe(t){return $("MuiStepLabel",t)}const T=D("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),Oe=t=>{const{classes:o,orientation:n,active:r,completed:c,error:d,disabled:m,alternativeLabel:u}=t;return B({root:["root",n,d&&"error",m&&"disabled",u&&"alternativeLabel"],label:["label",r&&"active",c&&"completed",d&&"error",m&&"disabled",u&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",c&&"completed",d&&"error",m&&"disabled",u&&"alternativeLabel"],labelContainer:["labelContainer",u&&"alternativeLabel"]},Fe,o)},Ue=I("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:n}=t;return[o.root,o[n.orientation]]}})({display:"flex",alignItems:"center",[`&.${T.alternativeLabel}`]:{flexDirection:"column"},[`&.${T.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),Ae=I("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(t,o)=>o.label})(F(({theme:t})=>({...t.typography.body2,display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${T.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${T.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${T.alternativeLabel}`]:{marginTop:16},[`&.${T.error}`]:{color:(t.vars||t).palette.error.main}}))),Ee=I("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(t,o)=>o.iconContainer})({flexShrink:0,display:"flex",paddingRight:8,[`&.${T.alternativeLabel}`]:{paddingRight:0}}),Je=I("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(t,o)=>o.labelContainer})(F(({theme:t})=>({width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${T.alternativeLabel}`]:{textAlign:"center"}}))),H=i.forwardRef(function(o,n){const r=W({props:o,name:"MuiStepLabel"}),{children:c,className:d,componentsProps:m={},error:u=!1,icon:l,optional:v,slots:x={},slotProps:s={},StepIconComponent:b,StepIconProps:S,...w}=r,{alternativeLabel:C,orientation:M}=i.useContext(A),{active:R,disabled:N,completed:a,icon:p}=i.useContext(X),h=l||p;let g=b;h&&!g&&(g=Be);const j={...r,active:R,alternativeLabel:C,completed:a,disabled:N,error:u,orientation:M},f=Oe(j),z={slots:x,slotProps:{stepIcon:S,...m,...s}},[ae,O]=K("label",{elementType:Ae,externalForwardedProps:z,ownerState:j}),[G,re]=K("stepIcon",{elementType:g,externalForwardedProps:z,ownerState:j});return e.jsxs(Ue,{className:P(f.root,d),ref:n,ownerState:j,...w,children:[h||G?e.jsx(Ee,{className:f.iconContainer,ownerState:j,children:e.jsx(G,{completed:a,active:R,error:u,icon:h,...re})}):null,e.jsxs(Je,{className:f.labelContainer,ownerState:j,children:[c?e.jsx(ae,{...O,className:P(f.label,O==null?void 0:O.className),children:c}):null,v]})]})});H&&(H.muiName="StepLabel");function Ve(t){return $("MuiStepConnector",t)}D("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const _e=t=>{const{classes:o,orientation:n,alternativeLabel:r,active:c,completed:d,disabled:m}=t,u={root:["root",n,r&&"alternativeLabel",c&&"active",d&&"completed",m&&"disabled"],line:["line",`line${oe(n)}`]};return B(u,Ve,o)},qe=I("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:n}=t;return[o.root,o[n.orientation],n.alternativeLabel&&o.alternativeLabel,n.completed&&o.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),He=I("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(t,o)=>{const{ownerState:n}=t;return[o.line,o[`line${oe(n.orientation)}`]]}})(F(({theme:t})=>{const o=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return{display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:o,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),Xe=i.forwardRef(function(o,n){const r=W({props:o,name:"MuiStepConnector"}),{className:c,...d}=r,{alternativeLabel:m,orientation:u="horizontal"}=i.useContext(A),{active:l,disabled:v,completed:x}=i.useContext(X),s={...r,alternativeLabel:m,orientation:u,active:l,completed:x,disabled:v},b=_e(s);return e.jsx(qe,{className:P(b.root,c),ref:n,ownerState:s,...d,children:e.jsx(He,{className:b.line,ownerState:s})})});function Ge(t){return $("MuiStepper",t)}D("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const Ke=t=>{const{orientation:o,nonLinear:n,alternativeLabel:r,classes:c}=t;return B({root:["root",o,n&&"nonLinear",r&&"alternativeLabel"]},Ge,c)},Ye=I("div",{name:"MuiStepper",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:n}=t;return[o.root,o[n.orientation],n.alternativeLabel&&o.alternativeLabel,n.nonLinear&&o.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),Qe=e.jsx(Xe,{}),Ze=i.forwardRef(function(o,n){const r=W({props:o,name:"MuiStepper"}),{activeStep:c=0,alternativeLabel:d=!1,children:m,className:u,component:l="div",connector:v=Qe,nonLinear:x=!1,orientation:s="horizontal",...b}=r,S={...r,nonLinear:x,alternativeLabel:d,orientation:s,component:l},w=Ke(S),C=i.Children.toArray(m).filter(Boolean),M=C.map((N,a)=>i.cloneElement(N,{index:a,last:a+1===C.length,...N.props})),R=i.useMemo(()=>({activeStep:c,alternativeLabel:d,connector:v,nonLinear:x,orientation:s}),[c,d,v,x,s]);return e.jsx(A.Provider,{value:R,children:e.jsx(Ye,{as:l,ownerState:S,className:P(w.root,u),ref:n,...b,children:M})})}),et=I("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),ne=({onSubmitSuccess:t})=>{const[o,n]=i.useState({category:"",newCategory:"",courseName:"",courseCode:"",description:"",thumbnail:null}),[r,c]=i.useState(!1),[d,m]=i.useState(null);console.log("🚀 ~ CreateCourseForm ~ startDate:",d);const[u,l]=i.useState([]),[v,x]=i.useState(!1),[s,b]=i.useState([{code:"",description:""}]);i.useEffect(()=>{Y.get("/categories").then(a=>l(a.data.data)).catch(a=>console.error("Failed to fetch categories:",a))},[]);const S=a=>p=>{const h=p.target.value;n(g=>({...g,[a]:h})),a==="category"&&c(h==="new")},w=a=>{const p=a.target.files[0];n(h=>({...h,thumbnail:p}))},C=(a,p,h)=>{const g=[...s];g[a][p]=h,b(g)},M=()=>{b([...s,{code:"",description:""}])},R=a=>{if(s.length>1){const p=s.filter((h,g)=>g!==a);b(p)}},N=async a=>{var g,j;a.preventDefault(),x(!0);const p=new FormData,h={name:o.courseName,code:o.courseCode,description:o.description,startDate:d,categoryName:o.category==="new"?o.newCategory:o.category,outcomes:s.filter(f=>f.code&&f.description)};p.append("courseInfo",new Blob([JSON.stringify(h)],{type:"application/json"})),o.thumbnail&&p.append("thumbnail",o.thumbnail);try{const f=await Y.post("/courses",p,{headers:{"Content-Type":"multipart/form-data"}});if(f.status===200){U.success(f.data.message);const z=f.data.data;localStorage.setItem("courseInfo",JSON.stringify(z)),t()}else U.error(f.data.message)}catch(f){console.error("Error submitting form:",f),U.error(((j=(g=f.response)==null?void 0:g.data)==null?void 0:j.message)||"Error occurred")}finally{x(!1)}};return e.jsx(ie,{dateAdapter:ce,children:e.jsx(de,{maxWidth:"lg",sx:{pb:4},children:e.jsxs(pe,{elevation:3,sx:{borderRadius:3,overflow:"hidden",position:"relative"},children:[v&&e.jsx(L,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsx(Q,{})}),e.jsxs(L,{component:"form",onSubmit:N,children:[e.jsx(L,{sx:{background:"linear-gradient(135deg, #5BCEC9 0%, #14919B 100%)",color:"white",p:1,textAlign:"center"},children:e.jsx(E,{variant:"h6",component:"h1",fontWeight:"bold",children:"Tạo khóa học mới"})}),e.jsx(L,{sx:{p:4},children:e.jsxs(y,{container:!0,spacing:3,children:[e.jsx(y,{item:!0,xs:12,children:e.jsxs(ue,{fullWidth:!0,children:[e.jsx(he,{children:"Danh mục"}),e.jsxs(me,{value:o.category,label:"Danh mục",onChange:S("category"),children:[e.jsx(V,{value:"",children:"Chọn danh mục"}),u.map(a=>e.jsx(V,{value:a.name,children:a.name},a.id)),e.jsx(V,{value:"new",children:"Thêm danh mục mới"})]})]})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(xe,{in:r,children:e.jsx(k,{fullWidth:!0,label:"Tên danh mục mới",value:o.newCategory,onChange:S("newCategory"),placeholder:"Nhập tên danh mục mới"})})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,required:!0,label:"Mã môn học",value:o.courseCode,onChange:S("courseCode"),placeholder:"Ví dụ: CS101, MATH201",inputProps:{style:{textTransform:"uppercase"}},helperText:"Mã môn học nên ngắn gọn và duy nhất"})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,required:!0,label:"Tên khóa học",value:o.courseName,onChange:S("courseName"),placeholder:"Nhập tên khóa học"})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,required:!0,multiline:!0,rows:4,label:"Mô tả",value:o.description,onChange:S("description"),placeholder:"Nhập mô tả khóa học"})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(ve,{label:"Ngày bắt đầu",value:d,onChange:a=>m(a),format:"dd/MM/yyyy",slotProps:{textField:{fullWidth:!0,required:!0}}})}),e.jsx(y,{item:!0,xs:12,children:e.jsxs(L,{sx:{mb:2},children:[e.jsxs(E,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:["Chuẩn đầu ra (Learning Outcomes)",e.jsx(J,{variant:"outlined",size:"small",startIcon:e.jsx(be,{}),onClick:M,sx:{ml:"auto"},children:"Thêm chuẩn đầu ra"})]}),s.map((a,p)=>e.jsx(fe,{sx:{mb:2,border:"1px solid #e0e0e0"},children:e.jsx(ge,{children:e.jsxs(L,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[e.jsx(L,{sx:{flex:1},children:e.jsxs(y,{container:!0,spacing:2,children:[e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(k,{fullWidth:!0,label:`Mã chuẩn đầu ra ${p+1}`,value:a.code,onChange:h=>C(p,"code",h.target.value),placeholder:"Ví dụ: CLO1, PLO2",size:"small"})}),e.jsx(y,{item:!0,xs:12,md:9,children:e.jsx(k,{fullWidth:!0,label:"Mô tả chuẩn đầu ra",value:a.description,onChange:h=>C(p,"description",h.target.value),placeholder:"Mô tả chi tiết về chuẩn đầu ra này",multiline:!0,rows:2,size:"small"})})]})}),s.length>1&&e.jsx(Se,{onClick:()=>R(p),color:"error",size:"small",children:e.jsx(Ce,{})})]})})},p))]})}),e.jsx(y,{item:!0,xs:12,children:e.jsxs(L,{children:[e.jsx(E,{variant:"subtitle1",gutterBottom:!0,children:"Ảnh nền"}),e.jsxs(J,{component:"label",variant:"outlined",startIcon:e.jsx(je,{}),sx:{width:"100%",height:56,borderStyle:"dashed",borderWidth:2},children:[o.thumbnail?o.thumbnail.name:"Chọn ảnh nền",e.jsx(et,{type:"file",accept:"image/*",onChange:w})]})]})})]})}),e.jsx(L,{sx:{backgroundColor:"#f8fafc",p:3,display:"flex",justifyContent:"center"},children:e.jsx(J,{type:"submit",variant:"contained",size:"large",startIcon:e.jsx(ye,{}),disabled:v,sx:{minWidth:200,py:1.5,background:"linear-gradient(135deg, #5BCEC9 0%, #14919B 100%)",boxShadow:2,"&:hover":{background:"linear-gradient(135deg, #5BCEC9 0%, #14919B 100%)",boxShadow:4},"&:disabled":{background:"#ccc"}},children:v?e.jsx(Q,{size:24,color:"inherit"}):"Tạo khóa học"})})]})]})})})};ne.propTypes={onSubmitSuccess:le.func.isRequired};const ee=["Tạo khoá học mới","Tạo nội dung khoá học","Xác nhận"];function tt(){const[t,o]=i.useState(0),n=Le(),[r,c]=i.useState(()=>{const l=localStorage.getItem("courseInfo");return l?JSON.parse(l):{}}),d=i.useRef(null);i.useEffect(()=>{localStorage.setItem("courseInfo",JSON.stringify(r))},[r]);const m=()=>{t<ee.length-1&&o(l=>l+1)},u=async()=>{d.current&&await d.current();const{id:l}=JSON.parse(localStorage.getItem("courseInfo"));localStorage.removeItem("courseInfo"),localStorage.removeItem("sections"),n(`/course-detail/${l}`)};return e.jsxs(L,{sx:{width:"100%",mx:"16px"},children:[e.jsx(Ze,{activeStep:t,alternativeLabel:!0,children:ee.map(l=>e.jsx(ze,{children:e.jsx(H,{sx:{"& .MuiStepLabel-label":{fontSize:"0.825rem",fontWeight:"bold"},"& .MuiSvgIcon-root":{fontSize:"1.75rem",color:"#51C1BF"}},children:l})},l))}),e.jsxs(L,{sx:{mt:2},children:[t===0&&e.jsx(ne,{onSubmitSuccess:m}),t===1&&e.jsx(we,{onSubmitSuccess:()=>{m(),U.success("Tạo module thành công!")},initialModules:[]}),t===2&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("div",{className:"text-xl font-bold mb- text-slate-700 mb-4",children:"Xác nhận"}),e.jsx("p",{className:"text-lg text-slate-700 mb-4",children:"Lưu ý, hãy ấn vào nút ✔ sau khi đã điền thông tin khóa học."}),e.jsx(Me,{variant:"contained",color:"primary",onClick:u,children:"Chuyển hướng"})]})]})]})}const dt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Ie,{title:"Thêm khóa học"}),e.jsxs("div",{className:"min-h-[calc(100vh-170px)] bg-white shadow-sm m-4 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700 pl-6 pt-6",children:"Thêm khóa học"}),e.jsx(tt,{})]})]});export{dt as default};
