import{c as R,P as ae,W as C,r as a,j as e,aC as q,a3 as b,M as ne,N as le,aA as M,u as ie,ai as V,B as re,L as I,aD as O,aE as oe,$ as ce,aB as T,a4 as S,D as de}from"./index-DLaGDpFt.js";import{R as me}from"./quill.snow-C5W79Y4l.js";import{C as P}from"./Chip-Q4OAIvXW.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=R("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=R("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=R("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function W({timeRemaining:y}){const{assignmentId:p}=C(),[o,h]=a.useState([]);a.useEffect(()=>{(async()=>{await b.get(`/assignment-submissions/assignment/${p}`).then(x=>{h(x.data.data)}).catch(x=>{console.log(x)})})()},[p]),o.length;const v=o.filter(c=>c.fileSubmissionUrl||c.textSubmission).length,j=o.filter(c=>c.score===null||c.score===void 0).length;return e.jsxs("div",{className:" p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Th·ªëng k√™ ƒëi·ªÉm s·ªë"}),e.jsx("div",{className:"rounded-lg overflow-hidden bg-white shadow",children:e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsxs("td",{className:"py-3 flex items-center font-medium text-slate-700",children:[e.jsx(xe,{className:"w-5 h-5 text-green-500 mr-3"}),"ƒê√£ n·ªôp b√†i"]}),e.jsx("td",{className:"py-3 font-semibold text-slate-700",children:v})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsxs("td",{className:"py-3 flex items-center font-medium text-slate-700",children:[e.jsx(he,{className:"w-5 h-5 text-yellow-500 mr-3"}),"C·∫ßn ch·∫•m ƒëi·ªÉm"]}),e.jsx("td",{className:"py-3 font-semibold text-slate-700",children:j})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"py-3 flex items-center font-medium text-slate-700",children:[e.jsx(q,{className:"w-5 h-5 text-red-500 mr-3"}),"Th·ªùi gian c√≤n l·∫°i"]}),e.jsx("td",{className:"py-3 font-semibold text-slate-700",children:y})]})]})})})]})}W.propTypes={timeRemaining:ae.string.isRequired};var U={},fe=le;Object.defineProperty(U,"__esModule",{value:!0});var G=U.default=void 0,pe=fe(ne()),ge=e;G=U.default=(0,pe.default)((0,ge.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel");function be({title:y,content:p,startDate:o,endDate:h}){const[v,j]=a.useState(!1),[c,x]=a.useState(!0),[m,d]=a.useState(null);console.log("üöÄ ~ SubmissionLayout ~ uploadedFile:",m);const[N,K]=a.useState(null),[J,$]=a.useState(!1),[w,A]=a.useState(""),Q=o&&!isNaN(new Date(o))?M(new Date(o),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T}):"Invalid date",Z=h&&!isNaN(new Date(h))?M(new Date(h),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T}):"Invalid date",{authUser:F}=ie(),X=()=>{j(!v)},[Y,f]=a.useState(!0),[t,k]=a.useState(null),{assignmentId:D}=C(),{courseId:L}=C(),z=s=>{const i=new Date(h),n=new Date(s),l=n-i,r=Math.abs(l),u=Math.floor(r/(1e3*60*60*24)),g=Math.floor(r/(1e3*60*60)%24),_=Math.floor(r/(1e3*60)%60),B=Math.floor(r/1e3%60);return n<i?e.jsxs("td",{className:"py-3 text-blue-500",children:["N·ªôp s·ªõm ",u>0?`${u} ng√†y `:"",g," gi·ªù ",_," ph√∫t ",B," gi√¢y"]}):e.jsxs("td",{className:"py-3 text-rose-600",children:["N·ªôp tr·ªÖ ",u>0?`${u} ng√†y `:"",g," gi·ªù ",_," ph√∫t ",B," gi√¢y"]})},E=s=>{if(Array.isArray(s)&&s.length>=6){const[i,n,l,r,u,g]=s;return new Date(i,n-1,l,r,u,g)}return null};a.useEffect(()=>{(async()=>{f(!0);const i=await b.get(`courses/${L}`);i.status===200&&(K(i.data.data),f(!1))})()},[L]),a.useEffect(()=>{(async()=>{f(!0);try{const i=await b.get(`/assignment-submissions/${D}/logged-in`);k(i.data.data),A(i.data.data.textSubmission||"")}catch{k(null)}finally{f(!1)}})()},[D]);const H=s=>{const i=new Date,n=new Date(s);if(isNaN(n.getTime()))return"Ng√†y h·∫øt h·∫°n kh√¥ng h·ª£p l·ªá";const l=n.getTime()-i.getTime();if(l<=0)return"ƒê√£ h·∫øt h·∫°n";const r=Math.floor(l/(1e3*60*60*24)),u=Math.floor(l%(1e3*60*60*24)/(1e3*60*60)),g=Math.floor(l%(1e3*60*60)/(1e3*60));return r>0?`C√≤n l·∫°i ${r} ng√†y ${u} gi·ªù`:u>0?`C√≤n l·∫°i ${u} gi·ªù ${g} ph√∫t`:`C√≤n l·∫°i ${g} ph√∫t`},ee=()=>{x(!c)},se=s=>{d(s.target.files[0])},te=async()=>{var s,i;try{if(console.log("üöÄ ~ handleSubmitAssignmentSubmission ~ assignmentSubmission:",t),t){const n=new FormData;n.append("textSubmission",w),m&&n.append("document",m),f(!0);const l=await b.patch(`/assignment-submissions/${D}`,n,{headers:{"Content-Type":"multipart/form-data"}});f(!1),l.status===200?(S.success("Ch·ªânh s·ª≠a b√†i th√†nh c√¥ng"),k(l.data.data),j(!1)):S.error(l.data.message||"C√≥ l·ªói x·∫£y ra")}else{const n={assignmentId:parseInt(D),textSubmission:w},l=new FormData;l.append("assignment",new Blob([JSON.stringify(n)],{type:"application/json"})),l.append("document",m),f(!0);const r=await b.post("/assignment-submissions",l,{headers:{"Content-Type":"multipart/form-data"}});f(!1),r.status===201||r.status===200?(S.success("N·ªôp b√†i th√†nh c√¥ng"),k(r.data.data)):S.error(r.data.message||"C√≥ l·ªói x·∫£y ra")}}catch(n){f(!1),console.error("Error submitting assignment:",n),S.error(((i=(s=n.response)==null?void 0:s.data)==null?void 0:i.message)||"C√≥ l·ªói x·∫£y ra khi n·ªôp b√†i")}};return e.jsx("div",{className:"",children:Y?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(V,{isLoading:!0})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative h-48 bg-emerald-200 overflow-hidden",children:[e.jsx("img",{src:re,alt:"Online learning illustration",className:"w-full h-fit object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-start",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"bg-primaryDark text-white px-4 py-2 rounded-lg text-sm font-semibold shadow-md",children:e.jsx("nav",{"aria-label":"breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"fa-solid fa-file-arrow-up text-white text-xl mr-2"}),e.jsx("li",{children:e.jsx(I,{to:"/",className:"text-white hover:underline",children:"Trang ch·ªß"})}),e.jsx("li",{children:e.jsx("span",{className:"mx-2 text-gray-300",children:"/"})}),e.jsx("li",{children:e.jsx(I,{to:"/my-course",className:"text-white hover:underline",children:"Kh√≥a h·ªçc"})}),e.jsx("li",{children:e.jsx("span",{className:"mx-2 text-gray-300",children:"/"})}),e.jsx(I,{to:`/course-detail/${N==null?void 0:N.id}`,className:"text-white hover:underline",children:(N==null?void 0:N.name)||"ƒêang t·∫£i..."}),e.jsx("li",{children:e.jsx("span",{className:"mx-2 text-gray-300",children:"/"})}),e.jsx("li",{className:"text-gray-200",children:y||"ƒêang t·∫£i..."})]})})})})})]}),e.jsx("div",{className:"pt-4 relative",children:e.jsxs("div",{className:"bg-white shadow-lg overflow-hidden rounded-lg",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-slate-700",children:"Th·ªùi gian"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between text-sm text-gray-600",children:[e.jsxs("p",{className:"mb-2 sm:mb-0",children:[e.jsx(O,{className:"inline mr-2",size:16})," Opened: ",Q]}),e.jsxs("p",{children:[e.jsx(O,{className:"inline mr-2",size:16})," Due: ",Z]})]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-700 flex flex-col ",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-slate-700",children:"H∆∞·ªõng d·∫´n n·ªôp b√†i"}),e.jsx("div",{className:"pb-2",dangerouslySetInnerHTML:{__html:p}}),F.role==="TEACHER"?e.jsx(I,{to:`/grading/${L}/${D}`,className:"text-white flex justify-center",children:e.jsx("button",{className:"py-2 px-6  bg-primaryDark text-white rounded-lg  hover:bg-secondary transition-colors",children:"Ch·∫•m ƒëi·ªÉm"})}):e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:X,className:"py-2 px-6 bg-primaryDark text-white rounded-lg hover:bg-secondary transition-colors flex items-center w-fit gap-2",children:[e.jsx("i",{className:"fa-solid fa-folder-plus"}),t?"S·ª≠a b√†i n·ªôp":"Th√™m b√†i n·ªôp"]})}),v&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-slate-700",children:"N·ªôi dung b√†i l√†m"}),e.jsx(me,{theme:"snow",value:w,onChange:A,placeholder:"Nh·∫≠p n·ªôi dung b√†i l√†m c·ªßa b·∫°n...",style:{height:"200px",marginBottom:"50px"}})]}),e.jsx("h3",{className:"pl-4 text-lg font-semibold  text-slate-700",children:"File ƒë√≠nh k√®m (kh√¥ng b·∫Øt bu·ªôc)"}),e.jsxs("div",{className:`p-4 pt-6 bg-slate-50 rounded-lg shadow-md border-2 border-dashed transition-colors duration-200 ${J?"border-blue-400 bg-blue-50":"border-slate-300"}`,onDragOver:s=>{s.preventDefault(),$(!0)},onDragLeave:s=>{s.preventDefault(),$(!1)},onDrop:s=>{s.preventDefault(),$(!1),s.dataTransfer.files&&s.dataTransfer.files[0]&&d(s.dataTransfer.files[0])},onClick:()=>{var s;(s=document.getElementById("hidden-upload-input"))==null||s.click()},style:{cursor:"pointer"},children:[!m&&e.jsx("div",{className:"text-base font-semibold mb-6 text-center text-slate-500",children:"K√©o & th·∫£ file v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn file"}),m&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(P,{label:m.name,color:"primary",onDelete:()=>d(null),deleteIcon:e.jsx(G,{}),variant:"outlined",sx:{fontWeight:500,fontSize:15,px:1.5}})}),e.jsx("input",{id:"hidden-upload-input",type:"file",accept:".pdf,.doc,.docx,.xlsx,.xls",style:{display:"none"},onChange:se}),t&&!m&&t.fileSubmissionUrl&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(P,{label:decodeURIComponent(t.fileSubmissionUrl.split("/").pop()),color:"success",variant:"outlined",sx:{fontWeight:500,fontSize:15,px:1.5}})})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),A((t==null?void 0:t.textSubmission)||""),d(null)},className:"bg-slate-500 text-white text-m px-6 py-2 rounded-lg hover:bg-slate-600 transition-colors shadow-md",children:"H·ªßy"}),e.jsx("button",{onClick:s=>{s.stopPropagation(),te()},disabled:!w.trim()&&!m,className:`text-white text-m px-6 py-2 rounded-lg transition-colors shadow-md ${w.trim()||m?"bg-blue-500 hover:bg-blue-600":"bg-slate-300 cursor-not-allowed"}`,children:t?"C·∫≠p nh·∫≠t b√†i n·ªôp":"N·ªôp b√†i"})]})]})]}),F.role==="STUDENT"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 cursor-pointer",onClick:ee,children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:"Tr·∫°ng th√°i b√†i n·ªôp"}),c?e.jsx(oe,{size:20}):e.jsx(ce,{size:20})]}),c&&e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Th·ªùi gian n·ªôp"}),t?e.jsx(e.Fragment,{children:t.updatedAt?z(E(t.updatedAt)):z(E(t.createdAt))}):e.jsx("td",{className:"py-3 text-rose-600",children:"Ch∆∞a n·ªôp b√†i"})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"File ƒë√£ n·ªôp"}),t&&t.fileSubmissionUrl?e.jsx("td",{className:" text-gray-600",children:e.jsxs("div",{className:"flex",children:[e.jsx(ue,{className:"mr-2 text-blue-600",size:18}),e.jsx("a",{className:"text-blue-500 hover:underline",href:`http://docs.google.com/gview?url=${t.fileSubmissionUrl}&embedded=true`,children:decodeURIComponent(t.fileSubmissionUrl.split("/").pop())})]})}):e.jsx("td",{className:"py-3 text-gray-600"})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"ƒêi·ªÉm"}),e.jsx("td",{className:"py-3 text-gray-600",children:t?t.score?t.score:"Ch∆∞a ch·∫•m ƒëi·ªÉm":"..."})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Th·ªùi gian c√≤n l·∫°i"}),e.jsxs("td",{className:"py-3 text-gray-600 flex items-center",children:[e.jsx(q,{className:"mr-2",size:16}),H(h)]})]}),e.jsxs("tr",{className:"border-b border-slate-300",children:[e.jsx("td",{className:"py-3 font-medium text-gray-700",children:"Ch·ªânh s·ª≠a l·∫ßn cu·ªëi"}),e.jsx("td",{className:"py-3 text-gray-600",children:t&&t.updatedAt?M(E(t.updatedAt),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T}):t&&M(E(t.createdAt),"EEEE, dd 'th√°ng' MM yyyy, hh:mm a",{locale:T})})]})]})})]}),e.jsx("div",{className:"",children:F.role==="TEACHER"&&e.jsx(W,{timeRemaining:H(h)})})]})})]})})}const ve=()=>{const{courseId:y}=C(),{assignmentId:p}=C(),[o,h]=a.useState(null),[v,j]=a.useState(null),[c,x]=a.useState(!1);return a.useEffect(()=>{(async()=>{x(!0);try{const d=await b.get(`courses/${y}`);d.status===200&&j(d.data.data)}catch(d){console.log(d)}finally{x(!1)}})()},[y]),a.useEffect(()=>{(async()=>{x(!0);try{const d=await b.get(`/assignments/${p}`,{headers:{"Content-Type":"application/json"}});h(d.data.data)}catch(d){console.log(d)}finally{x(!1)}})()},[p]),e.jsxs(e.Fragment,{children:[e.jsx(de,{title:"N·ªôp b√†i"}),e.jsx("div",{className:"flex flex-col min-h-[calc(100vh-170px)]",children:e.jsx("div",{className:"flex-1 pr-6 pl-6",children:c?e.jsx(V,{isLoading:c,className:"flex justify-center items-center h-full"}):o&&e.jsx(be,{title:o.title,content:o.content,startDate:o.startDate,endDate:o.endDate})})})]})};export{ve as default};
